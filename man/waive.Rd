% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/maivefunction.r
\name{waive}
\alias{waive}
\title{R code for WAIVE}
\usage{
waive(dat, method, weight, instrument, studylevel, SE, AR, first_stage = 0L)
}
\arguments{
\item{dat}{Data frame with columns bs, sebs, Ns, study_id (optional).}

\item{method}{1 FAT-PET, 2 PEESE, 3 PET-PEESE, 4 EK.}

\item{weight}{0 no weights, 1 standard weights, 2 MAIVE adjusted weights, 3 WAIVE weights.}

\item{instrument}{1 yes, 0 no.}

\item{studylevel}{Correlation at study level: 0 none, 1 fixed effects, 2 cluster.}

\item{SE}{SE estimator: 0 CR0 (Huber–White), 1 CR1 (Standard empirical correction),
2 CR2 (Bias-reduced estimator), 3 wild bootstrap.}

\item{AR}{Anderson Rubin corrected CI for weak instruments (only for unweighted MAIVE versions
of PET, PEESE, PET-PEESE, not available for fixed effects): 0 no, 1 yes.}

\item{first_stage}{First-stage specification for the variance model: 0 levels, 1 log.}
}
\value{
List with the same structure as \code{maive()}. See \code{?maive} for details.
}
\description{
WAIVE (Weighted Adjusted Instrumental Variable Estimator) extends MAIVE by applying
exponential-decay weights that smoothly downweight studies with spurious precision
or extreme outlier behavior. The first-stage instrumentation remains identical to MAIVE,
but the second-stage regression uses additional robustness weighting.
}
\details{
WAIVE computes decay weights from first-stage residuals:
\itemize{
  \item Negative residuals (spurious precision) → downweighted linearly
  \item Extreme residuals (|z| > 2) → downweighted quadratically
  \item Weight floor at 0.05 prevents complete exclusion
  \item Weights normalized to mean = 1
}

The decay weights are applied by multiplying them with instrumented variances:
\code{w = sqrt(sebs2_instrumented * decay_weights)}

This ensures studies with spuriously small variances or extreme behavior
receive less influence in the meta-analytic estimate.

All other WAIVE components (instruments, AR CIs, standard errors, clustering)
work identically to MAIVE.
}
\examples{
\dontrun{
# Basic WAIVE usage
dat <- data.frame(
  bs = c(0.5, 0.45, 0.55, 0.6),
  sebs = c(0.25, 0.2, 0.22, 0.27),
  Ns = c(50, 80, 65, 90)
)

# WAIVE with PET-PEESE
result <- waive(
  dat = dat,
  method = 3,        # PET-PEESE
  weight = 0,        # Unweighted base (WAIVE decay applied automatically)
  instrument = 1,    # Use instrumented SEs
  studylevel = 0,    # No study-level clustering
  SE = 0,            # CR0 standard errors
  AR = 0,            # No AR CI (disabled for WAIVE)
  first_stage = 0    # Levels specification
)
}

}
\seealso{
\code{\link{maive}}
}
